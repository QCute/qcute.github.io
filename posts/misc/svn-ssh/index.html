<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="VarKai"><title>SVN使用SSH ｜ 轻作</title><meta name=description content="SSH配置方面和通常用Git一样，密码或者Key。 当SVN使用SSH时，SVN用户名用的就是SSH登录的用户名，所以配置就很简单明了。 仓库认证配置 conf/authz [/] ... # 本机用户名 = 权限 username = rw ... 仓库密码配置 conf/passwd [users] ... # 为"><meta name=keywords content="Hugo,theme,graphite"><link rel="shortcut icon" href=https://qcute.github.io/images/favicon.ico><link rel=stylesheet type=text/css media=screen href=https://unpkg.com/normalize.css@8.0.1/normalize.css><link rel=stylesheet type=text/css media=screen href=https://unpkg.com/animate.css@4.1.1/animate.min.css><link rel=stylesheet type=text/css media=screen href=https://unpkg.com/remixicon@2.5.0/fonts/remixicon.css><link rel=stylesheet type=text/css media=screen href=https://unpkg.com/@fancyapps/ui@4.0.27/dist/fancybox.css><link rel=stylesheet type=text/css media=screen href=/css/highlight.min.css><link rel=stylesheet type=text/css media=screen href=/css/graphite.min.css></head><body><div class="main animate__animated animate__fadeInDown"><div class="nav_container animated fadeInDown"><div class=site_nav id=site_nav><ul><li><a href=/>首页</a></li><li><a href=/categories/>分类</a></li><li><a href=/tags/>标签</a></li><li><a href=/posts/>归档</a></li><li><a href=/about/>关于</a></li><li><a href=/search/ title=搜索 id=site_search><i class=ri-search-line></i></a></li></ul></div><div class=menu_icon><a id=menu_icon><i class=ri-menu-line></i></a></div></div><div class="header animated fadeInDown"><div class=site_title_container><div class=site_title><h1><a href=https://qcute.github.io/><span><img src=https://gohugo.io/favicon.ico></span></a></h1></div><div class=description><h1 style=float:right><a><span>轻作</span></a></h1><br><br><p class=sub_title>重拾写作的乐趣</p><div class=my_socials><a href=https://github.com/QCute title=github target=_blank><i class=ri-github-fill></i></a>
<a href=https://www.zhihu.com/people/tui-fei-er-you-ya-de-shen-shi title=zhihu target=_blank><i class=ri-zhihu-fill></i></a>
<a href=https://qcute.github.io/index.xml type=application/rss+xml title=rss target=_blank><i class=ri-rss-fill></i></a></div></div></div></div><div class=content><div class=post_page><div class="post animate__animated animate__fadeInDown"><div class="post_title post_detail_title"><h2><a href=/posts/misc/svn-ssh/>SVN使用SSH</a></h2><span class=date>2020.03.07</span></div><div class="post_content markdown"><p><a href=http://www.openssh.com/>SSH</a>配置方面和通常用<a href=https://git-scm.com/>Git</a>一样，密码或者Key。<br>当<a href=https://subversion.apache.org/>SVN</a>使用<a href>SSH</a>时，<a href=https://subversion.apache.org/>SVN</a>用户名用的就是<a href=http://www.openssh.com/>SSH</a>登录的用户名，所以配置就很简单明了。</p><p>仓库认证配置 <a href>conf/authz</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[/]</span>
</span></span><span class=line><span class=cl><span class=na>...</span>
</span></span><span class=line><span class=cl><span class=c1># 本机用户名 = 权限</span>
</span></span><span class=line><span class=cl><span class=na>username</span> <span class=o>=</span> <span class=s>rw</span>
</span></span><span class=line><span class=cl><span class=na>...</span>
</span></span></code></pre></div><p>仓库密码配置 <a href>conf/passwd</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[users]</span>
</span></span><span class=line><span class=cl><span class=na>...</span>
</span></span><span class=line><span class=cl><span class=c1># 为了方便使用，无密码</span>
</span></span><span class=line><span class=cl><span class=c1># 本机用户名 = </span>
</span></span><span class=line><span class=cl><span class=na>username</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=na>...</span>
</span></span></code></pre></div><p>当<a href=http://www.openssh.com/>SSH</a>端口不是22的时候</p><p>配置 <a href>~/.subversion/config</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[tunnels]</span>
</span></span><span class=line><span class=cl><span class=na>...</span>
</span></span><span class=line><span class=cl><span class=na>ssh</span> <span class=o>=</span> <span class=s>ssh -p 22222</span>
</span></span><span class=line><span class=cl><span class=na>...</span>
</span></span></code></pre></div><p>然后</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># 使用绝对SVN目录路径</span>
</span></span><span class=line><span class=cl>svn checkout svn+ssh://USERNAME@SSH_HOST/path/to/the-svn-repo
</span></span></code></pre></div><p>要想禁止<a href=http://www.openssh.com/>SSH</a> Key登录shell, 需要在<a href>.ssh/authorized_keys</a>上设置</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># --tunnel-user 不设置默认就是SSH用户名
</span></span><span class=line><span class=cl>command=&#34;svnserve --root=&lt;ReposRootPath&gt; --tunnel --tunnel-user=&lt;RepoAuthUsername&gt;&#34;,no-port-forwarding,no-agent-forwarding,no-X11-forwarding,no-pty ssh-rsa &lt;YourPublicKey&gt; &lt;Comment&gt;
</span></span></code></pre></div><p>然后</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># 使用相对SVN根目录路径</span>
</span></span><span class=line><span class=cl>svn checkout svn+ssh://USERNAME@SSH_HOST/the-svn-repo
</span></span></code></pre></div><p>想要像<a href=https://git-scm.com/docs/git-shell>git-shelll</a>一样, 可使用<a href=https://github.com/QCute/svn-shell>svn-shell</a>, 这样就可以在正常服务的同时禁止<a href=http://www.openssh.com/>SSH</a> Key登录并显示友好信息</p><p><a href=https://www.microsoft.com/windows>Widdows</a>客户端使用参考</p><blockquote><p><a href=https://tortoisesvn.net/ssh_howto.html>Securing Svnserve using SSH</a></p></blockquote><p>用户以及用户组等和平常运维时一样</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Match User git
</span></span><span class=line><span class=cl>    X11Forwarding no
</span></span><span class=line><span class=cl>    AllowTcpForwarding no
</span></span><span class=line><span class=cl>    PermitTTY no
</span></span><span class=line><span class=cl>    AuthenticationMethods publickey
</span></span><span class=line><span class=cl>    ForceCommand /bin/bash -c &#34;if [[ -n \&#34;$SSH_ORIGINAL_COMMAND\&#34; ]];then /bin/git-shell -c \&#34;$SSH_ORIGINAL_COMMAND\&#34;; else /bin/git-shell; fi&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Match User svn
</span></span><span class=line><span class=cl>    X11Forwarding no
</span></span><span class=line><span class=cl>    AllowTcpForwarding no
</span></span><span class=line><span class=cl>    PermitTTY no
</span></span><span class=line><span class=cl>    AuthenticationMethods publickey
</span></span><span class=line><span class=cl>    ForceCommand /bin/bash -c &#34;if [[ -n \&#34;$SSH_ORIGINAL_COMMAND\&#34; ]];then /bin/svn-shell -c \&#34;$SSH_ORIGINAL_COMMAND\&#34;; else /bin/svn-shell; fi&#34;
</span></span></code></pre></div></div><div class=post_footer></div></div><div class=doc_comments><div class=comments_block_title>发表评论</div><div id=comments></div></div><script src=https://giscus.app/client.js data-repo=QCute/qcute.github.io data-repo-id=R_kgDOG-5qXQ data-category=Announcements data-category-id=DIC_kwDOG-5qXc4CSRb_ data-mapping=url data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></div></div></div><a id=back_to_top href=# class=back_to_top><i class=ri-arrow-up-s-line></i></a><footer class=footer><div class=powered_by><a href=https://varkai.com>Designed by VarKai,</a>
<a href=http://www.gohugo.io/>Proudly published with Hugo</a></div><div class=footer_slogan><span>轻作、重拾写作的乐趣</span></div></footer><script src=https://unpkg.com/elevator.js@1.0.1/elevator.min.js></script>
<script src=https://unpkg.com/dom-slider@2.1.6/dist/dom-slider.js></script>
<script src=https://unpkg.com/@fancyapps/ui@4.0.27/dist/fancybox.umd.js></script>
<script src=/js/graphite.min.js></script>
<script>MathJax={options:{skipHtmlTags:["script","noscript","style","textarea","pre"]},tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["[[","]]"]],processEscapes:!0,processEnvironments:!0}}</script><script type=text/javascript id=MathJax-script async src=https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js></script></body></html>