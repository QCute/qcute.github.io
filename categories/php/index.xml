<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Php on 轻作</title><link>https://qcute.github.io/categories/php/</link><description>Recent content in Php on 轻作</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><managingEditor>759276607@qq.com (QCute)</managingEditor><webMaster>759276607@qq.com (QCute)</webMaster><lastBuildDate>Mon, 09 Mar 2020 00:00:00 +0800</lastBuildDate><atom:link href="https://qcute.github.io/categories/php/index.xml" rel="self" type="application/rss+xml"/><item><title>LaravelAdmin在Laravel8以上页面消息出现两次的问题</title><link>https://qcute.github.io/posts/php/laravel-admin-session-flash-to-now/</link><pubDate>Mon, 09 Mar 2020 00:00:00 +0800</pubDate><author>759276607@qq.com (QCute)</author><guid>https://qcute.github.io/posts/php/laravel-admin-session-flash-to-now/</guid><description>&lt;p>解决&lt;a href="https://laravel-admin.org">LaravelAdmin&lt;/a>在&lt;a href="https://laravel.com/">Laravel&lt;/a> 8及以上, 使用&lt;a href="https://laravel-admin.org/docs/zh/1.x/content-message">页面消息&lt;/a>出现两次的问题&lt;/p>
&lt;p>把&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">session&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="na">flash&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$type&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nv">$message&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>改成&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">session&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="na">now&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$type&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nv">$message&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>即可&lt;/p>
&lt;p>影响的函数&lt;/p>
&lt;ul>
&lt;li>&lt;a href="">admin_success&lt;/a>&lt;/li>
&lt;li>&lt;a href="">admin_error&lt;/a>&lt;/li>
&lt;li>&lt;a href="">admin_warning&lt;/a>&lt;/li>
&lt;li>&lt;a href="">admin_info&lt;/a>&lt;/li>
&lt;li>&lt;a href="">admin_toastr&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>但是, 在&lt;a href="https://laravel-admin.org/docs/zh/1.x/data-form">数据表单&lt;/a>, handle函数里面使用, 以上函数会失效&lt;br>
所以, 要么改, 然后在&lt;a href="https://laravel-admin.org/docs/zh/1.x/data-form">数据表单&lt;/a>里使用&lt;a href="">session()-&amp;gt;flash&lt;/a>&lt;br>
要么不改, 然后在正常表单里使用&lt;a href="">session()-&amp;gt;now&lt;/a>&lt;/p></description></item><item><title>PHP JIT Core Dump问题</title><link>https://qcute.github.io/posts/php/php-jit-core-dump/</link><pubDate>Mon, 09 Mar 2020 00:00:00 +0800</pubDate><author>759276607@qq.com (QCute)</author><guid>https://qcute.github.io/posts/php/php-jit-core-dump/</guid><description>&lt;p>记一次&lt;a href="https://github.com/laravel/framework">Laravel&lt;/a> &lt;a href="https://github.com/laravel/octane">Octane&lt;/a>(&lt;a href="https://github.com/swoole/swoole-src">Swoole&lt;/a>)在&lt;a href="https://github.com/php/php-src">PHP&lt;/a>8开启jit造成的core dump的问题&lt;/p>
&lt;p>原jit配置&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ini" data-lang="ini">&lt;span class="line">&lt;span class="cl">&lt;span class="na">opcache.jit&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">1255&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>改成&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ini" data-lang="ini">&lt;span class="line">&lt;span class="cl">&lt;span class="na">opcache.jit&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">1205 &lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>即可&lt;/p></description></item><item><title>PHP 浮点数转整形问题</title><link>https://qcute.github.io/posts/php/float-to-integer/</link><pubDate>Mon, 09 Mar 2020 00:00:00 +0800</pubDate><author>759276607@qq.com (QCute)</author><guid>https://qcute.github.io/posts/php/float-to-integer/</guid><description>&lt;p>PHP使用&lt;a href="">int&lt;/a>或&lt;a href="">intval&lt;/a>转换浮点数会导致精度丢失问题&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">var_dump&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mf">19.90&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## float(1990)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">var_dump&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">intval&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mf">19.90&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## int(1989)
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>实际开发要用下面代码的来进行转换&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">var_dump&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">floatval&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mf">19.90&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## float(1990)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">intval&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">round&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">floatval&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mf">19.90&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## int(1990)
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Symfony Process组件交互式进程问题</title><link>https://qcute.github.io/posts/php/symfony-process/</link><pubDate>Mon, 09 Mar 2020 00:00:00 +0800</pubDate><author>759276607@qq.com (QCute)</author><guid>https://qcute.github.io/posts/php/symfony-process/</guid><description>&lt;p>&lt;a href="https://symfony.com/">Symfony&lt;/a> &lt;a href="https://symfony.com/doc/current/components/process.html">Process&lt;/a>组件使用&lt;a href="http://www.openssh.com/">SSH&lt;/a>交互的问题&lt;/p>
&lt;p>打开&lt;a href="https://symfony.com/doc/current/components/process.html#using-tty-and-pty-modes">PTY&lt;/a>模式即可&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$env&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;PATH&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="nx">getenv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;PATH&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="s1">&amp;#39;SSH_AUTH_SOCK&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="nx">getenv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;SSH_AUTH_SOCK&amp;#39;&lt;/span>&lt;span class="p">)]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$process&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="nx">Process&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="s1">&amp;#39;ssh&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;username@host&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;echo 1&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="k">null&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nv">$env&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// turning on PTY support
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nv">$process&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="na">setPty&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">true&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$process&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="na">run&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">echo&lt;/span> &lt;span class="nv">$process&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="na">getOutput&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考&lt;/p>
&lt;blockquote>
&lt;p>&lt;a href="https://github.com/symfony/symfony/issues/12518">Controlling an interactive process&lt;/a>&lt;/p>&lt;/blockquote></description></item></channel></rss>