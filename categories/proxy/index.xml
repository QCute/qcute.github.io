<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Proxy on 轻作</title><link>https://qcute.github.io/categories/proxy/</link><description>Recent content in Proxy on 轻作</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Tue, 03 Mar 2020 00:00:00 +0800</lastBuildDate><atom:link href="https://qcute.github.io/categories/proxy/index.xml" rel="self" type="application/rss+xml"/><item><title>Windows系统代理脚本</title><link>https://qcute.github.io/posts/batch/proxy/</link><pubDate>Tue, 03 Mar 2020 00:00:00 +0800</pubDate><guid>https://qcute.github.io/posts/batch/proxy/</guid><description>&lt;p>Windows 10下设置系统代理老是要打开设置 -&amp;gt; 网络 -&amp;gt; 代理&lt;br>
于是写了个脚本来设置和开启/关闭代理&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bat" data-lang="bat">&lt;span class="line">&lt;span class="cl">&lt;span class="p">@&lt;/span>&lt;span class="k">echo&lt;/span> off
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chcp 65001&lt;span class="p">&amp;gt;&lt;/span>nul
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">SetLocal&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">:&lt;/span>&lt;span class="c1">: status&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> &lt;span class="k">/f&lt;/span> &lt;span class="se">%%&lt;/span>i &lt;span class="k">in&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;PowerShell -NoLogo -NonInteractive -NoProfile -Command &amp;#34;$(Get-ItemProperty -Path \&amp;#34;HKCU:\Software\Microsoft\Windows\CurrentVersion\Internet Settings\&amp;#34; -Name \&amp;#34;ProxyEnable\&amp;#34;).ProxyEnable&amp;#34;&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">set&lt;/span> &lt;span class="nv">status&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="se">%%&lt;/span>i
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">:&lt;/span>&lt;span class="c1">: server&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> &lt;span class="k">/f&lt;/span> &lt;span class="se">%%&lt;/span>i &lt;span class="k">in&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;PowerShell -NoLogo -NonInteractive -NoProfile -Command &amp;#34;$(Get-ItemProperty -Path \&amp;#34;HKCU:\Software\Microsoft\Windows\CurrentVersion\Internet Settings\&amp;#34; -Name \&amp;#34;ProxyServer\&amp;#34;).ProxyServer&amp;#34;&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">set&lt;/span> &lt;span class="nv">server&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="se">%%&lt;/span>i
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">:&lt;/span>&lt;span class="c1">: toggle&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">%1&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span> &lt;span class="k">goto&lt;/span> &lt;span class="nl">toggle&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">:&lt;/span>&lt;span class="nl">proxy&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PowerShell -NoLogo -NonInteractive -NoProfile -Command &lt;span class="s2">&amp;#34;Write-Host &amp;#39;Found proxy address &amp;#39; -NoNewLine ; Write-Host -Fore Cyan &amp;#39;&lt;/span>&lt;span class="nv">%server%&lt;/span>&lt;span class="s2">&amp;#39; -NoNewLine ; Write-Host &amp;#39; from argument, &amp;#39; -NoNewLine ; Write-Host -Fore Green &amp;#39;enable&amp;#39; -NoNewLine ; Write-Host &amp;#39; system proxy...&amp;#39;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">reg add &lt;span class="s2">&amp;#34;HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings&amp;#34;&lt;/span> /v ProxyEnable /t REG_DWORD /d 1 /f &lt;span class="p">&amp;gt;&lt;/span>nul &lt;span class="mi">2&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>nul
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">reg add &lt;span class="s2">&amp;#34;HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings&amp;#34;&lt;/span> /v ProxyServer /d &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">%1&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> /f &lt;span class="p">&amp;gt;&lt;/span>nul &lt;span class="mi">2&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>nul
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">goto&lt;/span> &lt;span class="nl">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">:&lt;/span>&lt;span class="nl">toggle&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">%server%&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span> &lt;span class="k">goto&lt;/span> &lt;span class="nl">disable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">%status%&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s2">&amp;#34;1&amp;#34;&lt;/span> &lt;span class="k">goto&lt;/span> &lt;span class="nl">disable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">:&lt;/span>&lt;span class="nl">enable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PowerShell -NoLogo -NonInteractive -NoProfile -Command &lt;span class="s2">&amp;#34;Write-Host &amp;#39;Found proxy address &amp;#39; -NoNewLine ; Write-Host -Fore Blue &amp;#39;&lt;/span>&lt;span class="nv">%server%&lt;/span>&lt;span class="s2">&amp;#39; -NoNewLine ; Write-Host &amp;#39; from registry, &amp;#39; -NoNewLine ; Write-Host -Fore Green &amp;#39;enable&amp;#39; -NoNewLine ; Write-Host &amp;#39; system proxy...&amp;#39;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">reg add &lt;span class="s2">&amp;#34;HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings&amp;#34;&lt;/span> /v ProxyEnable /t REG_DWORD /d 1 /f &lt;span class="p">&amp;gt;&lt;/span>nul &lt;span class="mi">2&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>nul
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">goto&lt;/span> &lt;span class="nl">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">:&lt;/span>&lt;span class="nl">disable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PowerShell -NoLogo -NonInteractive -NoProfile -Command &lt;span class="s2">&amp;#34;Write-Host &amp;#39;Proxy &amp;#39; -NoNewLine ; Write-Host -Fore Blue &amp;#39;IP:PORT&amp;#39; -NoNewLine ; Write-Host &amp;#39; not set, &amp;#39; -NoNewLine ; Write-Host -Fore Red &amp;#39;disable&amp;#39; -NoNewLine ; Write-Host &amp;#39; system proxy...&amp;#39;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">reg add &lt;span class="s2">&amp;#34;HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings&amp;#34;&lt;/span> /v ProxyEnable /t REG_DWORD /d 0 /f &lt;span class="p">&amp;gt;&lt;/span>nul &lt;span class="mi">2&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>nul
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">goto&lt;/span> &lt;span class="nl">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">:&lt;/span>&lt;span class="nl">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">EndLocal&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>设置并开启代理&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bat" data-lang="bat">&lt;span class="line">&lt;span class="cl">proxy.bat 127.0.0.1:1080
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>开启/关闭代理&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bat" data-lang="bat">&lt;span class="line">&lt;span class="cl">proxy.bat
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>注册表参考&lt;/p></description></item></channel></rss>